# h200sxm Scaled Dot Product Attention (SDPA) Test Results 

This report shows the results of testing different SDPA configurations with various input sizes on a h200sxm GPU.

## Table Explanation:
- **dimensions**: The dimensions of the input tensor
- **chanels**: The channels of the input tensor
- **lengths**: The lengths of the input tensor in every dimension
- **success**: Whether the SDPA operation completed successfully
- **peak memory (GB)**: Maximum GPU memory usage during the SDPA operation
- **backend mem**: Whether the memory-efficient SDPA implementation was enabled
- **backend flash**: Whether the Flash Attention implementation was enabled
- **backend math**: Whether the math SDPA implementation was enabled
- **error**: Error message if the operation failed, None otherwise
## Results for 2 dimensions:

|   dimensions |   channels |   length | success   |   peak memory | backend mem   | backend flash   | backend math   | error                                    |
|-------------:|-----------:|---------:|:----------|--------------:|:--------------|:----------------|:---------------|:-----------------------------------------|
|            2 |          1 |       32 | False     |       nan     | True          | False           | False          | No available kernel. Aborting execution. |
|            2 |          1 |       32 | False     |       nan     | False         | True            | False          | No available kernel. Aborting execution. |
|            2 |          1 |       32 | True      |         0.032 | False         | False           | True           |                                          |
|            2 |          1 |       64 | False     |       nan     | True          | False           | False          | No available kernel. Aborting execution. |
|            2 |          1 |       64 | False     |       nan     | False         | True            | False          | No available kernel. Aborting execution. |
|            2 |          1 |       64 | True      |         0.032 | False         | False           | True           |                                          |
|            2 |          1 |      128 | False     |       nan     | True          | False           | False          | No available kernel. Aborting execution. |
|            2 |          1 |      128 | False     |       nan     | False         | True            | False          | No available kernel. Aborting execution. |
|            2 |          1 |      128 | True      |         0.033 | False         | False           | True           |                                          |
|            2 |          1 |      256 | False     |       nan     | True          | False           | False          | No available kernel. Aborting execution. |
|            2 |          1 |      256 | False     |       nan     | False         | True            | False          | No available kernel. Aborting execution. |
|            2 |          1 |      256 | True      |         0.036 | False         | False           | True           |                                          |
|            2 |          1 |      512 | False     |       nan     | True          | False           | False          | No available kernel. Aborting execution. |
|            2 |          1 |      512 | False     |       nan     | False         | True            | False          | No available kernel. Aborting execution. |
|            2 |          1 |      512 | True      |         0.049 | False         | False           | True           |                                          |
|            2 |          1 |     1024 | False     |       nan     | True          | False           | False          | No available kernel. Aborting execution. |
|            2 |          1 |     1024 | False     |       nan     | False         | True            | False          | No available kernel. Aborting execution. |
|            2 |          1 |     1024 | True      |         0.099 | False         | False           | True           |                                          |
|            2 |          2 |       32 | False     |       nan     | True          | False           | False          | No available kernel. Aborting execution. |
|            2 |          2 |       32 | False     |       nan     | False         | True            | False          | No available kernel. Aborting execution. |
|            2 |          2 |       32 | True      |         0.032 | False         | False           | True           |                                          |
|            2 |          2 |       64 | False     |       nan     | True          | False           | False          | No available kernel. Aborting execution. |
|            2 |          2 |       64 | False     |       nan     | False         | True            | False          | No available kernel. Aborting execution. |
|            2 |          2 |       64 | True      |         0.033 | False         | False           | True           |                                          |
|            2 |          2 |      128 | False     |       nan     | True          | False           | False          | No available kernel. Aborting execution. |
|            2 |          2 |      128 | False     |       nan     | False         | True            | False          | No available kernel. Aborting execution. |
|            2 |          2 |      128 | True      |         0.034 | False         | False           | True           |                                          |
|            2 |          2 |      256 | False     |       nan     | True          | False           | False          | No available kernel. Aborting execution. |
|            2 |          2 |      256 | False     |       nan     | False         | True            | False          | No available kernel. Aborting execution. |
|            2 |          2 |      256 | True      |         0.041 | False         | False           | True           |                                          |
|            2 |          2 |      512 | False     |       nan     | True          | False           | False          | No available kernel. Aborting execution. |
|            2 |          2 |      512 | False     |       nan     | False         | True            | False          | No available kernel. Aborting execution. |
|            2 |          2 |      512 | True      |         0.065 | False         | False           | True           |                                          |
|            2 |          2 |     1024 | False     |       nan     | True          | False           | False          | No available kernel. Aborting execution. |
|            2 |          2 |     1024 | False     |       nan     | False         | True            | False          | No available kernel. Aborting execution. |
|            2 |          2 |     1024 | True      |         0.165 | False         | False           | True           |                                          |
|            2 |          8 |       32 | False     |       nan     | True          | False           | False          | No available kernel. Aborting execution. |
|            2 |          8 |       32 | False     |       nan     | False         | True            | False          | No available kernel. Aborting execution. |
|            2 |          8 |       32 | True      |         0.033 | False         | False           | True           |                                          |
|            2 |          8 |       64 | False     |       nan     | True          | False           | False          | No available kernel. Aborting execution. |
|            2 |          8 |       64 | False     |       nan     | False         | True            | False          | No available kernel. Aborting execution. |
|            2 |          8 |       64 | True      |         0.034 | False         | False           | True           |                                          |
|            2 |          8 |      128 | False     |       nan     | True          | False           | False          | No available kernel. Aborting execution. |
|            2 |          8 |      128 | False     |       nan     | False         | True            | False          | No available kernel. Aborting execution. |
|            2 |          8 |      128 | True      |         0.041 | False         | False           | True           |                                          |
|            2 |          8 |      256 | False     |       nan     | True          | False           | False          | No available kernel. Aborting execution. |
|            2 |          8 |      256 | False     |       nan     | False         | True            | False          | No available kernel. Aborting execution. |
|            2 |          8 |      256 | True      |         0.065 | False         | False           | True           |                                          |
|            2 |          8 |      512 | False     |       nan     | True          | False           | False          | No available kernel. Aborting execution. |
|            2 |          8 |      512 | False     |       nan     | False         | True            | False          | No available kernel. Aborting execution. |
|            2 |          8 |      512 | True      |         0.165 | False         | False           | True           |                                          |
|            2 |          8 |     1024 | False     |       nan     | True          | False           | False          | No available kernel. Aborting execution. |
|            2 |          8 |     1024 | False     |       nan     | False         | True            | False          | No available kernel. Aborting execution. |
|            2 |          8 |     1024 | True      |         0.563 | False         | False           | True           |                                          |

## Results for 3 dimensions:

|   dimensions |   channels |   length | success   |   peak memory | backend mem   | backend flash   | backend math   | error                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|-------------:|-----------:|---------:|:----------|--------------:|:--------------|:----------------|:---------------|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|            3 |          1 |       32 | False     |       nan     | True          | False           | False          | No available kernel. Aborting execution.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|            3 |          1 |       32 | False     |       nan     | False         | True            | False          | No available kernel. Aborting execution.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|            3 |          1 |       32 | True      |         0.035 | False         | False           | True           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|            3 |          1 |       64 | False     |       nan     | True          | False           | False          | No available kernel. Aborting execution.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|            3 |          1 |       64 | False     |       nan     | False         | True            | False          | No available kernel. Aborting execution.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|            3 |          1 |       64 | True      |         0.057 | False         | False           | True           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|            3 |          1 |      128 | False     |       nan     | True          | False           | False          | No available kernel. Aborting execution.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|            3 |          1 |      128 | False     |       nan     | False         | True            | False          | No available kernel. Aborting execution.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|            3 |          1 |      128 | True      |         0.228 | False         | False           | True           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|            3 |          1 |      256 | False     |       nan     | True          | False           | False          | No available kernel. Aborting execution.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|            3 |          1 |      256 | False     |       nan     | False         | True            | False          | No available kernel. Aborting execution.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|            3 |          1 |      256 | True      |         1.595 | False         | False           | True           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|            3 |          1 |      512 | False     |       nan     | True          | False           | False          | No available kernel. Aborting execution.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|            3 |          1 |      512 | False     |       nan     | False         | True            | False          | No available kernel. Aborting execution.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|            3 |          1 |      512 | True      |        12.532 | False         | False           | True           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|            3 |          1 |     1024 | False     |       nan     | True          | False           | False          | No available kernel. Aborting execution.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|            3 |          1 |     1024 | False     |       nan     | False         | True            | False          | No available kernel. Aborting execution.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|            3 |          1 |     1024 | True      |       100.032 | False         | False           | True           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|            3 |          2 |       32 | False     |       nan     | True          | False           | False          | No available kernel. Aborting execution.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|            3 |          2 |       32 | False     |       nan     | False         | True            | False          | No available kernel. Aborting execution.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|            3 |          2 |       32 | True      |         0.038 | False         | False           | True           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|            3 |          2 |       64 | False     |       nan     | True          | False           | False          | No available kernel. Aborting execution.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|            3 |          2 |       64 | False     |       nan     | False         | True            | False          | No available kernel. Aborting execution.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|            3 |          2 |       64 | True      |         0.081 | False         | False           | True           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|            3 |          2 |      128 | False     |       nan     | True          | False           | False          | No available kernel. Aborting execution.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|            3 |          2 |      128 | False     |       nan     | False         | True            | False          | No available kernel. Aborting execution.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|            3 |          2 |      128 | True      |         0.423 | False         | False           | True           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|            3 |          2 |      256 | False     |       nan     | True          | False           | False          | No available kernel. Aborting execution.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|            3 |          2 |      256 | False     |       nan     | False         | True            | False          | No available kernel. Aborting execution.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|            3 |          2 |      256 | True      |         3.157 | False         | False           | True           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|            3 |          2 |      512 | False     |       nan     | True          | False           | False          | No available kernel. Aborting execution.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|            3 |          2 |      512 | False     |       nan     | False         | True            | False          | No available kernel. Aborting execution.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|            3 |          2 |      512 | True      |        25.032 | False         | False           | True           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|            3 |          2 |     1024 | False     |       nan     | True          | False           | False          | at::cuda::blas::gemm<float> argument n must be non-negative and less than 2147483647 but got 2147483648                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|            3 |          2 |     1024 | False     |       nan     | False         | True            | False          | at::cuda::blas::gemm<float> argument n must be non-negative and less than 2147483647 but got 2147483648                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|            3 |          2 |     1024 | False     |       nan     | False         | False           | True           | at::cuda::blas::gemm<float> argument n must be non-negative and less than 2147483647 but got 2147483648                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|            3 |          8 |       32 | False     |       nan     | True          | False           | False          | No available kernel. Aborting execution.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|            3 |          8 |       32 | False     |       nan     | False         | True            | False          | No available kernel. Aborting execution.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|            3 |          8 |       32 | True      |         0.057 | False         | False           | True           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|            3 |          8 |       64 | False     |       nan     | True          | False           | False          | No available kernel. Aborting execution.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|            3 |          8 |       64 | False     |       nan     | False         | True            | False          | No available kernel. Aborting execution.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|            3 |          8 |       64 | True      |         0.228 | False         | False           | True           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|            3 |          8 |      128 | False     |       nan     | True          | False           | False          | No available kernel. Aborting execution.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|            3 |          8 |      128 | False     |       nan     | False         | True            | False          | No available kernel. Aborting execution.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|            3 |          8 |      128 | True      |         1.595 | False         | False           | True           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|            3 |          8 |      256 | False     |       nan     | True          | False           | False          | No available kernel. Aborting execution.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|            3 |          8 |      256 | False     |       nan     | False         | True            | False          | No available kernel. Aborting execution.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|            3 |          8 |      256 | True      |        12.532 | False         | False           | True           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|            3 |          8 |      512 | False     |       nan     | True          | False           | False          | No available kernel. Aborting execution.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|            3 |          8 |      512 | False     |       nan     | False         | True            | False          | No available kernel. Aborting execution.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|            3 |          8 |      512 | True      |       100.032 | False         | False           | True           |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|            3 |          8 |     1024 | False     |       nan     | True          | False           | False          | CUDA out of memory. Tried to allocate 288.00 GiB. GPU 0 has a total capacity of 139.72 GiB of which 43.20 GiB is free. Including non-PyTorch memory, this process has 96.51 GiB memory in use. Of the allocated memory 96.00 GiB is allocated by PyTorch, and 2.00 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables) |
|            3 |          8 |     1024 | False     |       nan     | False         | True            | False          | CUDA out of memory. Tried to allocate 288.00 GiB. GPU 0 has a total capacity of 139.72 GiB of which 43.20 GiB is free. Including non-PyTorch memory, this process has 96.51 GiB memory in use. Of the allocated memory 96.00 GiB is allocated by PyTorch, and 2.00 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables) |
|            3 |          8 |     1024 | False     |       nan     | False         | False           | True           | CUDA out of memory. Tried to allocate 288.00 GiB. GPU 0 has a total capacity of 139.72 GiB of which 43.20 GiB is free. Including non-PyTorch memory, this process has 96.51 GiB memory in use. Of the allocated memory 96.00 GiB is allocated by PyTorch, and 2.00 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables) |

